library(caret)
library(ggplot2)
library(lattice)
library(e1071)
library(nnet)
library(ROCR)
data = read.csv("data/team_season.csv", header = T)
#data
#0-35 1 poor
#35-50 2 average
#50-70 3 good
#70-100 4 outstanding
wins = data$won*100/(data$won+data$lost)
#wins
winClass = c(1:684)
for (i in c(1:684)){
  if (wins[i] <= 35) {
    winClass[i] = 1
  }
  else if (wins[i] > 35 && wins[i] <= 50){
    winClass[i] = 2
  }
  else if (wins[i] > 50 && wins[i] <= 70){
    winClass[i] = 3
  }
  else {
    winClass[i] = 4
  }
}
head(winClass)
head(wins)
pca = prcomp(data[,3:33], center = T, scale. = T)
summary(pca)
components = preProcess(data[,3:33], method=c("center", "scale", "pca"))
(components)

pcaData = cbind(predict(components, data[,3:33]), wins, winClass)

#pcaData[1,]

## 75% of the sample size
smp_size <- floor(0.75 * nrow(pcaData))

## set the seed to make your partition reproductible
set.seed(123)
train_ind <- sample(seq_len(nrow(pcaData)), size = smp_size)

train <- pcaData[train_ind, ]
test <- pcaData[-train_ind, ]

model = lm(wins~PC1+PC2+PC3+PC4+PC5+PC6+PC7+PC8+PC9+PC10, data = train)

#model

outcomes = predict.lm(model, test[,1:10])

trainOutput = predict.lm(model)
trainError = mean((trainOutput - train[,11])^2)
trainError

#head(outcomes)
#head(test[,11])

testError = mean((outcomes - test[,11])^2)
testError

neural = nnet(wins ~ PC1+PC2+PC3+PC4+PC5+PC6+PC7+PC8+PC9+PC10, data=pcaData, size = 2)
#neural

neuralOut = predict(neural, newdata = test[,1:10])
testErrorN = mean((neuralOut - test[,11])^2)
testErrorN

svmModel = svm(winClass ~ PC1+PC2+PC3+PC4+PC5+PC6+PC7+PC8+PC9+PC10, data = train, type = 'C-classification')
svmModel

svmPredict = predict(svmModel, newdata = test[,1:10])

head(test[,12])
head(svmPredict)

c = confusionMatrix(svmPredict, test[,12])

(c)

plot(svmPredict)

svmModel1 = svm(wins ~ PC1+PC2+PC3+PC4+PC5+PC6+PC7+PC8+PC9+PC10, data = train)
svmPredict1 = predict(svmModel1, newdata = test[,1:10])
#svmPredict1
svmError = mean((svmPredict1 - test[,11])^2)
svmError

trainS = predict(svmModel1)
svmError = mean((trainS - train[,11])^2)
svmError 
